<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>Expense Tracker Pro</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  body{font-family:Segoe UI,Arial;background:#0f172a;margin:0;color:#fff}
  .container{max-width:900px;margin:24px auto;padding:8px}
  .grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px;margin-top:12px}
  .card{background:#111827;border-radius:14px;padding:16px;box-shadow:0 8px 20px rgba(0,0,0,.35)}
  h2{margin:0 0 6px}
  input,select{padding:9px;border-radius:8px;border:1px solid #334155;background:#020617;color:#fff}
  button{padding:9px 14px;border-radius:8px;border:none;background:#3b82f6;color:#fff;cursor:pointer}
  button:hover{background:#2563eb}
  .row{display:flex;gap:8px}
  table{width:100%;border-collapse:collapse;margin-top:10px}
  th,td{padding:10px;border-bottom:1px solid #1f2937}
  th{text-align:left;background:#020617}
  .income{color:#4ade80}
  .expense{color:#fb7185}
  .badge{padding:3px 8px;border-radius:10px;background:#020617;font-size:11px;margin-left:6px}
  .summary{font-size:22px}
  .toolbar{display:flex;gap:8px;flex-wrap:wrap}
</style>
</head>

<body>
<div class="container">

  <h2>ðŸ’° Expense Tracker â€” Pro Dashboard</h2>

  <div class="toolbar">
    <select id="monthFilter" onchange="render()"></select>
    <input id="search" placeholder="Search..." oninput="render()" />
    <select id="sort" onchange="render()">
      <option value="latest">Sort: Latest</option>
      <option value="amountHigh">Amount High â†’ Low</option>
      <option value="amountLow">Amount Low â†’ High</option>
    </select>
  </div>

  <div class="grid">
    <div class="card">
      <div class="summary">â‚¹<span id="inc">0</span></div>
      <div>Income</div>
    </div>
    <div class="card">
      <div class="summary">â‚¹<span id="exp">0</span></div>
      <div>Expense</div>
    </div>
    <div class="card">
      <div class="summary">â‚¹<span id="bal">0</span></div>
      <div>Balance</div>
    </div>
  </div>

  <div class="card" style="margin-top:12px">
    <h3>Add Transaction</h3>
    <div class="row">
      <input id="title" placeholder="Title" />
      <input id="amount" type="number" placeholder="Amount" />
      <select id="type">
        <option value="income">Income</option>
        <option value="expense">Expense</option>
      </select>
      <select id="cat">
        <option>Food</option><option>Bills</option><option>Shopping</option>
        <option>Travel</option><option>Salary</option><option>Other</option>
      </select>
      <button onclick="addItem()">Add</button>
    </div>
  </div>

  <div class="grid">
    <div class="card">
      <h3>Category Summary</h3>
      <canvas id="chart"></canvas>
    </div>

    <div class="card" style="grid-column:span 2">
      <h3>Transactions</h3>
      <table>
        <thead>
          <tr>
            <th>Title</th><th>Category</th><th>Amount</th><th>Date</th><th></th>
          </tr>
        </thead>
        <tbody id="rows"></tbody>
      </table>
    </div>
  </div>

</div>

<script>
let items = JSON.parse(localStorage.getItem("expPro") || "[]");
const mSel=document.getElementById("monthFilter");

function initMonths(){
  const months=[...new Set(items.map(x=>x.month))].sort().reverse();
  mSel.innerHTML=`<option value="all">All Months</option>`+
    months.map(m=>`<option>${m}</option>`).join("");
}
initMonths();

function save(){ localStorage.setItem("expPro",JSON.stringify(items)); }

function addItem(){
  const t=title.value.trim(), a=+amount.value;
  if(!t||!a) return;
  const d=new Date(), month=`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}`;
  items.push({t,a,type:type.value,cat:cat.value,date:d.toLocaleDateString(),month});
  title.value=""; amount.value=""; save(); initMonths(); render();
}

function removeItem(i){ items.splice(i,1); save(); render(); }

function render(){
  const search=document.getElementById("search").value.toLowerCase();
  const sort=document.getElementById("sort").value;
  const month=mSel.value;

  let data=[...items].filter(x=>
    (month==="all"||x.month===month) &&
    (x.t.toLowerCase().includes(search) || x.cat.toLowerCase().includes(search))
  );

  if(sort==="amountHigh") data.sort((a,b)=>b.a-a.a);
  if(sort==="amountLow") data.sort((a,b)=>a.a-b.a);
  if(sort==="latest") data.sort((a,b)=>new Date(b.date)-new Date(a.date));

  let inc=0,exp=0,catSum={};
  rows.innerHTML="";
  data.forEach((x,i)=>{
    if(x.type==="income") inc+=x.a; else exp+=x.a;
    catSum[x.cat]=(catSum[x.cat]||0)+x.a;

    rows.innerHTML+=`
      <tr>
        <td>${x.t}</td>
        <td>${x.cat}</td>
        <td class="${x.type}">â‚¹${x.a}</td>
        <td>${x.date}</td>
        <td><button onclick="removeItem(${i})">Delete</button></td>
      </tr>`;
  });

  inc.innerText=inc; exp.innerText=exp; bal.innerText=inc-exp;

  drawChart(catSum);
}

let chart;
function drawChart(obj){
  const labels=Object.keys(obj), values=Object.values(obj);
  if(chart) chart.destroy();
  chart=new Chart(document.getElementById("chart"),{
    type:"pie",
    data:{labels,datasets:[{data:values} ]},
    options:{plugins:{legend:{labels:{color:"#fff"}}}}
  });
}

render();
</script>
</body>
</html>
